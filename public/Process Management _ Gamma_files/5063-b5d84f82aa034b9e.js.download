"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5063],{93665:function(e,t){t.DF={prefix:"fad",iconName:"circle-exclamation",icon:[512,512,["exclamation-circle"],"f06a",["M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z","M280 152c0-13.3-10.7-24-24-24s-24 10.7-24 24V264c0 13.3 10.7 24 24 24s24-10.7 24-24V152zM256 384a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"]]},t.xH=t.DF},56574:function(e,t){t.DF={prefix:"fad",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071",["M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z","M280 184c0-13.3-10.7-24-24-24s-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184zM256 416a32 32 0 1 0 0-64 32 32 0 1 0 0 64z"]]},t.ik=t.DF},76133:function(e,t,n){n.d(t,{z:function(){return o}});var s=n(2784);function o(e,t=[]){return(0,s.useEffect)(()=>()=>e(),t)}},67702:function(e,t,n){n.d(t,{JL:function(){return p}});var s=n(69180),o=n(52780),i=n(27191),r=n(36069),a=n(38564),c=n(68053);let l=e=>{let t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style",`border-color: ${e.color}`);let n=document.createElement("div");n.setAttribute("style",`background-color: ${e.color}`),n.insertBefore(document.createTextNode(e.name),null);let s=document.createTextNode("⁠"),o=document.createTextNode("⁠");return t.insertBefore(s,null),t.insertBefore(n,null),t.insertBefore(o,null),t},u=e=>({style:`background-color: ${e.color}70`,class:"ProseMirror-yjs-selection"}),h=/^#[0-9a-fA-F]{6}$/,d=(e,t,n,i)=>{let l=a.Gt.getState(e),u=l.doc,d=[];return null!=l.snapshot||null!=l.prevSnapshot||null===l.binding?o.EH.create(e.doc,[]):(t.getStates().forEach((t,a)=>{if(a!==u.clientID&&null!=t.cursor){let p=t.user||{};null==p.color?p.color="#ffa500":h.test(p.color)||console.warn("A user uses an unsupported color format",p),null==p.name&&(p.name=`User: ${a}`);let f=(0,r.SF)(u,l.type,s.og(t.cursor.anchor),l.binding.mapping),g=(0,r.SF)(u,l.type,s.og(t.cursor.head),l.binding.mapping);if(null!==f&&null!==g){let t=c.Fp(e.doc.content.size-1,0);f=c.VV(f,t),g=c.VV(g,t),d.push(o.p.widget(g,()=>n(p),{key:a+"",side:10}));let s=c.VV(f,g),r=c.Fp(f,g);d.push(o.p.inline(s,r,i(p),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),o.EH.create(e.doc,d))},p=(e,{cursorBuilder:t=l,selectionBuilder:n=u,getSelection:o=e=>e.selection}={},c="cursor")=>new i.Sy({key:a.uJ,state:{init:(s,o)=>d(o,e,t,n),apply(s,o,i,r){let c=a.Gt.getState(r),l=s.getMeta(a.uJ);return c&&c.isChangeOrigin||l&&l.awarenessUpdated?d(r,e,t,n):o.map(s.mapping,s.doc)}},props:{decorations:e=>a.uJ.getState(e)},view:t=>{let n=()=>{t.docView&&(0,r.US)(t,a.uJ,{awarenessUpdated:!0})},i=()=>{let n=a.Gt.getState(t.state),i=e.getLocalState()||{};if(null!=n.binding){if(t.hasFocus()){let a=o(t.state),l=(0,r.JR)(a.anchor,n.type,n.binding.mapping),u=(0,r.JR)(a.head,n.type,n.binding.mapping);null!=i.cursor&&s.Uq(s.og(i.cursor.anchor),l)&&s.Uq(s.og(i.cursor.head),u)||e.setLocalStateField(c,{anchor:l,head:u})}else null!=i.cursor&&null!==(0,r.SF)(n.doc,n.type,s.og(i.cursor.anchor),n.binding.mapping)&&e.setLocalStateField(c,null)}};return e.on("change",n),t.dom.addEventListener("focusin",i),t.dom.addEventListener("focusout",i),{update:i,destroy:()=>{t.dom.removeEventListener("focusin",i),t.dom.removeEventListener("focusout",i),e.off("change",n),e.setLocalStateField(c,null)}}}})},79522:function(e,t,n){let s;n.d(t,{$c:function(){return l},CL:function(){return E},NI:function(){return M},QX:function(){return I},nw:function(){return T},rN:function(){return $}});var o,i,r,a,c,l,u=n(34406);let h=e=>e.toLowerCase(),d=/^\s*/g,p=e=>e.replace(d,""),f=/([A-Z])/g,g=(e,t)=>p(e.replace(f,e=>`${t}${h(e)}`));"undefined"!=typeof TextEncoder&&new TextEncoder;let m="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});m&&1===m.decode(new Uint8Array).length&&(m=null);let y=()=>new Map,b=e=>void 0===e?null:e,w=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}};try{"undefined"!=typeof localStorage&&(w=localStorage)}catch(e){}let S=w,v=void 0!==u&&u.release&&/node|io\.js/.test(u.release.name);"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);o="--"+(i="production"),(()=>{if(void 0===s){if(v){s=y();let e=u.argv,t=null;for(let n=0;n<e.length;n++){let o=e[n];"-"===o[0]?(null!==t&&s.set(t,""),t=o):null!==t&&(s.set(t,o),t=null)}null!==t&&s.set(t,"")}else"object"==typeof location?(s=y(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,n]=e.split("=");s.set(`--${g(t,"-")}`,n),s.set(`-${g(t,"-")}`,n)}})):s=y()}return s})().has(o)||b(v?u.env[i.toUpperCase()]:S.getItem(i));let A=e=>e.arr[e.pos++],C=e=>{let t=0,n=0;for(;;){let s=e.arr[e.pos++];if(t|=(127&s)<<n,n+=7,s<128)return t>>>0;if(n>35)throw Error("Integer out of range!")}},D=e=>{let t=C(e);if(0===t)return"";{let n=String.fromCodePoint(A(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(A(e));else for(;t>0;){let s=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+s);e.pos+=s,n+=String.fromCodePoint.apply(null,o),t-=s}return decodeURIComponent(escape(n))}},k=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},U=(e,t)=>{for(;t>127;)k(e,128|127&t),t>>>=7;k(e,127&t)},x=(e,t)=>{let n=unescape(encodeURIComponent(t)),s=n.length;U(e,s);for(let t=0;t<s;t++)k(e,n.codePointAt(t))};(r=c||(c={}))[r.Token=0]="Token",r[r.PermissionDenied=1]="PermissionDenied",r[r.Authenticated=2]="Authenticated";let E=(e,t)=>{U(e,c.Token),x(e,t)},T=(e,t,n)=>{switch(C(e)){case c.PermissionDenied:t(D(e));break;case c.Authenticated:n()}},M={code:4401,reason:"Unauthorized"},$={code:4403,reason:"Forbidden"},I=e=>Array.from(e.entries()).map(([e,t])=>({clientId:e,...t}));(a=l||(l={}))[a.Connecting=0]="Connecting",a[a.Open=1]="Open",a[a.Closing=2]="Closing",a[a.Closed=3]="Closed"},44058:function(e,t,n){let s;n.d(t,{Ui:function(){return ez}});var o,i,r,a,c,l,u=n(69180);async function h(e){return new Promise((t,n)=>{setTimeout(t,e)})}function d(e,t){let n=t.delay;if(0===n)return 0;if(t.factor&&(n*=Math.pow(t.factor,e.attemptNum-1),0!==t.maxDelay&&(n=Math.min(n,t.maxDelay))),t.jitter){let e=Math.ceil(t.minDelay),s=Math.floor(n);n=Math.floor(Math.random()*(s-e+1))+e}return Math.round(n)}async function p(e,t){var n;let s=((n=t)||(n={}),{delay:void 0===n.delay?200:n.delay,initialDelay:void 0===n.initialDelay?0:n.initialDelay,minDelay:void 0===n.minDelay?0:n.minDelay,maxDelay:void 0===n.maxDelay?0:n.maxDelay,factor:void 0===n.factor?0:n.factor,maxAttempts:void 0===n.maxAttempts?3:n.maxAttempts,timeout:void 0===n.timeout?0:n.timeout,jitter:!0===n.jitter,handleError:void 0===n.handleError?null:n.handleError,handleTimeout:void 0===n.handleTimeout?null:n.handleTimeout,beforeAttempt:void 0===n.beforeAttempt?null:n.beforeAttempt,calculateDelay:void 0===n.calculateDelay?null:n.calculateDelay});for(let e of["delay","initialDelay","minDelay","maxDelay","maxAttempts","timeout"]){let t=s[e];if(!Number.isInteger(t)||t<0)throw Error(`Value for ${e} must be an integer greater than or equal to 0`)}if(s.factor.constructor!==Number||s.factor<0)throw Error("Value for factor must be a number greater than or equal to 0");if(s.delay<s.minDelay)throw Error(`delay cannot be less than minDelay (delay: ${s.delay}, minDelay: ${s.minDelay}`);let o={attemptNum:0,attemptsRemaining:s.maxAttempts?s.maxAttempts:-1,aborted:!1,abort(){o.aborted=!0}},i=s.calculateDelay||d;async function r(){if(s.beforeAttempt&&s.beforeAttempt(o,s),o.aborted){let e=Error("Attempt aborted");throw e.code="ATTEMPT_ABORTED",e}let t=async e=>{if(s.handleError&&await s.handleError(e,o,s),o.aborted||0===o.attemptsRemaining)throw e;o.attemptNum++;let t=i(o,s);return t&&await h(t),r()};return(o.attemptsRemaining>0&&o.attemptsRemaining--,s.timeout)?new Promise((n,i)=>{let r=setTimeout(()=>{if(s.handleTimeout)try{n(s.handleTimeout(o,s))}catch(e){i(e)}else{let e=Error(`Retry timeout (attemptNum: ${o.attemptNum}, timeout: ${s.timeout})`);e.code="ATTEMPT_TIMEOUT",i(e)}},s.timeout);e(o,s).then(e=>{clearTimeout(r),n(e)}).catch(e=>{clearTimeout(r),t(e).then(n).catch(i)})}):e(o,s).catch(t)}let a=s.calculateDelay?s.calculateDelay(o,s):s.initialDelay;return a&&await h(a),r()}var f=n(79522),g=n(34406),m=n(48834).lW;let y=()=>new Map,b=(e,t,n)=>{let s=e.get(t);return void 0===s&&e.set(t,s=n()),s},w=String.fromCharCode,S=e=>e.toLowerCase(),v=/^\s*/g,A=e=>e.replace(v,""),C=/([A-Z])/g,D=(e,t)=>A(e.replace(C,e=>`${t}${S(e)}`));"undefined"!=typeof TextEncoder&&new TextEncoder;let k="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});k&&1===k.decode(new Uint8Array).length&&(k=null);let U=e=>void 0===e?null:e,x=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},E=!0;try{"undefined"!=typeof localStorage&&(x=localStorage,E=!1)}catch(e){}let T=x,M=e=>E||addEventListener("storage",e),$=void 0!==g&&g.release&&/node|io\.js/.test(g.release.name),I="undefined"!=typeof window&&!$;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);o="--"+(i="production"),(()=>{if(void 0===s){if($){s=y();let e=g.argv,t=null;for(let n=0;n<e.length;n++){let o=e[n];"-"===o[0]?(null!==t&&s.set(t,""),t=o):null!==t&&(s.set(t,o),t=null)}null!==t&&s.set(t,"")}else"object"==typeof location?(s=y(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,n]=e.split("=");s.set(`--${D(t,"-")}`,n),s.set(`-${D(t,"-")}`,n)}})):s=y()}return s})().has(o)||U($?g.env[i.toUpperCase()]:T.getItem(i));let L=Math.floor,B=(e,t)=>e<t?e:t,R=(e,t)=>e>t?e:t;class P{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let V=()=>new P,O=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},j=e=>{let t=new Uint8Array(O(e)),n=0;for(let s=0;s<e.bufs.length;s++){let o=e.bufs[s];t.set(o,n),n+=o.length}return t.set(Y(e.cbuf.buffer,0,e.cpos),n),t},F=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},N=(e,t)=>{for(;t>127;)F(e,128|127&t),t>>>=7;F(e,127&t)},z=(e,t)=>{let n=unescape(encodeURIComponent(t)),s=n.length;N(e,s);for(let t=0;t<s;t++)F(e,n.codePointAt(t))},q=(e,t)=>{let n=e.cbuf.length,s=e.cpos,o=B(n-s,t.length),i=t.length-o;e.cbuf.set(t.subarray(0,o),s),e.cpos+=o,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(R(2*n,i)),e.cbuf.set(t.subarray(o)),e.cpos=i)},H=(e,t)=>{N(e,t.byteLength),q(e,t)};class Q{constructor(e){this.arr=e,this.pos=0}}let _=e=>new Q(e),W=(e,t)=>{let n=Y(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},J=e=>W(e,G(e)),X=e=>e.arr[e.pos++],G=e=>{let t=0,n=0;for(;;){let s=e.arr[e.pos++];if(t|=(127&s)<<n,n+=7,s<128)return t>>>0;if(n>35)throw Error("Integer out of range!")}},K=e=>{let t=G(e);if(0===t)return"";{let n=String.fromCodePoint(X(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(X(e));else for(;t>0;){let s=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+s);e.pos+=s,n+=String.fromCodePoint.apply(null,o),t-=s}return decodeURIComponent(escape(n))}},Z=e=>new Uint8Array(e),Y=(e,t,n)=>new Uint8Array(e,t,n),ee=e=>new Uint8Array(e),et=I?e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=w(e[n]);return btoa(t)}:e=>m.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),en=I?e=>{let t=atob(e),n=Z(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}:e=>{let t=m.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},es=new Map,eo="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,M(t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:en(t.newValue||"")}))}postMessage(e){T.setItem(this.room,et(ee(e)))}}:BroadcastChannel,ei=e=>b(es,e,()=>{let t=new Set,n=new eo(e);return n.onmessage=e=>t.forEach(t=>t(e.data)),{bc:n,subs:t}}),er=(e,t)=>ei(e).subs.add(t),ea=(e,t)=>ei(e).subs.delete(t),ec=(e,t)=>{let n=ei(e);n.bc.postMessage(t),n.subs.forEach(e=>e(t))},el=Date.now,eu=()=>new Set,eh=Array.from;class ed{constructor(){this._observers=y()}on(e,t){b(this._observers,e,eu).add(t)}once(e,t){let n=(...s)=>{this.off(e,n),t(...s)};this.on(e,n)}off(e,t){let n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return eh((this._observers.get(e)||y()).values()).forEach(e=>e(...t))}destroy(){this._observers=y()}}let ep=Object.keys,ef=(e,t)=>{let n=[];for(let s in e)n.push(t(e[s],s));return n},eg=e=>ep(e).length,em=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),ey=(e,t)=>e===t,eb=(e,t)=>{if(null==e||null==t)return ey(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(let n of e.keys())if(!t.has(n)||!eb(e.get(n),t.get(n)))return!1;break;case Object:if(eg(e)!==eg(t))return!1;for(let n in e)if(!em(e,n)||!eb(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!eb(e[n],t[n]))return!1;break;default:return!1}return!0};class ew extends ed{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let e=el();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let t=[];this.meta.forEach((n,s)=>{s!==this.clientID&&3e4<=e-n.lastUpdated&&this.states.has(s)&&t.push(s)}),t.length>0&&eS(this,t,"timeout")},L(3e3)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){let t=this.clientID,n=this.meta.get(t),s=void 0===n?0:n.clock+1,o=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:s,lastUpdated:el()});let i=[],r=[],a=[],c=[];null===e?c.push(t):null==o?null!=e&&i.push(t):(r.push(t),eb(o,e)||a.push(t)),(i.length>0||a.length>0||c.length>0)&&this.emit("change",[{added:i,updated:a,removed:c},"local"]),this.emit("update",[{added:i,updated:r,removed:c},"local"])}setLocalStateField(e,t){let n=this.getLocalState();null!==n&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}}let eS=(e,t,n)=>{let s=[];for(let n=0;n<t.length;n++){let o=t[n];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){let t=e.meta.get(o);e.meta.set(o,{clock:t.clock+1,lastUpdated:el()})}s.push(o)}}s.length>0&&(e.emit("change",[{added:[],updated:[],removed:s},n]),e.emit("update",[{added:[],updated:[],removed:s},n]))},ev=(e,t,n=e.states)=>{let s=t.length,o=V();N(o,s);for(let i=0;i<s;i++){let s=t[i],r=n.get(s)||null,a=e.meta.get(s).clock;N(o,s),N(o,a),z(o,JSON.stringify(r))}return j(o)},eA=(e,t,n)=>{let s=_(t),o=el(),i=[],r=[],a=[],c=[],l=G(s);for(let t=0;t<l;t++){let t=G(s),n=G(s),l=JSON.parse(K(s)),u=e.meta.get(t),h=e.states.get(t),d=void 0===u?0:u.clock;(d<n||d===n&&null===l&&e.states.has(t))&&(null===l?t===e.clientID&&null!=e.getLocalState()?n++:e.states.delete(t):e.states.set(t,l),e.meta.set(t,{clock:n,lastUpdated:o}),void 0===u&&null!==l?i.push(t):void 0!==u&&null===l?c.push(t):null!==l&&(eb(l,h)||a.push(t),r.push(t)))}(i.length>0||a.length>0||c.length>0)&&e.emit("change",[{added:i,updated:a,removed:c},n]),(i.length>0||r.length>0||c.length>0)&&e.emit("update",[{added:i,updated:r,removed:c},n])},eC=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==n&&n()}},eD=e=>ef(e,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&");class ek{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}class eU{constructor(e){this.data=e,this.encoder=V(),this.decoder=_(new Uint8Array(this.data))}readVarUint(){return G(this.decoder)}readVarUint8Array(){return J(this.decoder)}writeVarUint(e){return N(this.encoder,e)}writeVarUint8Array(e){return H(this.encoder,e)}length(){return O(this.encoder)}}let ex=(e,t)=>{N(e,0);let n=u.gJ(t);H(e,n)},eE=(e,t,n)=>{N(e,1),H(e,u.D$(t,n))},eT=(e,t,n)=>eE(t,n,J(e)),eM=(e,t,n)=>{try{u.NG(t,J(e),n)}catch(e){console.error("Caught error while handling a Yjs update",e)}},e$=(e,t)=>{N(e,2),H(e,t)},eI=(e,t,n,s)=>{let o=G(e);switch(o){case 0:eT(e,t,n);break;case 1:case 2:eM(e,n,s);break;default:throw Error("Unknown message type")}return o};(r=c||(c={}))[r.Sync=0]="Sync",r[r.Awareness=1]="Awareness",r[r.Auth=2]="Auth",r[r.QueryAwareness=3]="QueryAwareness",(a=l||(l={})).Connecting="connecting",a.Connected="connected",a.Disconnected="disconnected";class eL{constructor(){this.encoder=V()}get(e){return e.encoder}toUint8Array(){return j(this.encoder)}}class eB{constructor(e){this.broadcasted=!1,this.message=e}setBroadcasted(e){return this.broadcasted=e,this}apply(e,t=!0){let{message:n}=this,s=n.readVarUint();switch(s){case c.Sync:this.applySyncMessage(e,t);break;case c.Awareness:this.applyAwarenessMessage(e);break;case c.Auth:this.applyAuthMessage(e);break;case c.QueryAwareness:this.applyQueryAwarenessMessage(e);break;default:throw Error(`Can’t apply message of unknown type: ${s}`)}n.length()>1&&(this.broadcasted?e.broadcast(eL,{encoder:n.encoder}):e.send(eL,{encoder:n.encoder}))}applySyncMessage(e,t){let{message:n}=this;n.writeVarUint(c.Sync);let s=eI(n.decoder,n.encoder,e.document,e);t&&1===s&&(e.synced=!0),(2===s||1===s)&&e.unsyncedChanges>0&&(e.unsyncedChanges-=1)}applyAwarenessMessage(e){let{message:t}=this;eA(e.awareness,t.readVarUint8Array(),e)}applyAuthMessage(e){let{message:t}=this;(0,f.nw)(t.decoder,e.permissionDeniedHandler.bind(e),e.authenticatedHandler.bind(e))}applyQueryAwarenessMessage(e){let{message:t}=this;t.writeVarUint(c.Awareness),t.writeVarUint8Array(ev(e.awareness,Array.from(e.awareness.getStates().keys())))}}class eR{constructor(e,t={}){this.message=new e,this.encoder=this.message.get(t)}create(){return j(this.encoder)}send(e){null==e||e.send(this.create())}broadcast(e){ec(e,this.create())}}class eP extends eL{constructor(){super(...arguments),this.type=c.Sync,this.description="First sync step"}get(e){if(void 0===e.document)throw Error("The sync step one message requires document as an argument");return N(this.encoder,this.type),ex(this.encoder,e.document),this.encoder}}class eV extends eL{constructor(){super(...arguments),this.type=c.Sync,this.description="Second sync step"}get(e){if(void 0===e.document)throw Error("The sync step two message requires document as an argument");return N(this.encoder,this.type),eE(this.encoder,e.document),this.encoder}}class eO extends eL{constructor(){super(...arguments),this.type=c.QueryAwareness,this.description="Queries awareness states"}get(e){return N(this.encoder,this.type),this.encoder}}class ej extends eL{constructor(){super(...arguments),this.type=c.Auth,this.description="Authentication"}get(e){if(void 0===e.token)throw Error("The authentication message requires `token` as an argument.");return N(this.encoder,this.type),(0,f.CL)(this.encoder,e.token),this.encoder}}class eF extends eL{constructor(){super(...arguments),this.type=c.Awareness,this.description="Awareness states update"}get(e){let t;if(void 0===e.awareness)throw Error("The awareness message requires awareness as an argument");if(void 0===e.clients)throw Error("The awareness message requires clients as an argument");return N(this.encoder,this.type),t=void 0===e.states?ev(e.awareness,e.clients):ev(e.awareness,e.clients,e.states),H(this.encoder,t),this.encoder}}class eN extends eL{constructor(){super(...arguments),this.type=c.Sync,this.description="A document update"}get(e){return N(this.encoder,this.type),e$(this.encoder,e.update),this.encoder}}class ez extends ek{constructor(e){if(super(),this.configuration={name:"",url:"",document:void 0,awareness:void 0,WebSocketPolyfill:void 0,token:null,parameters:{},connect:!0,broadcast:!0,forceSyncInterval:!1,messageReconnectTimeout:3e4,delay:1e3,initialDelay:0,factor:2,maxAttempts:0,minDelay:1e3,maxDelay:3e4,jitter:!0,timeout:0,onAuthenticated:()=>null,onAuthenticationFailed:()=>null,onOpen:()=>null,onConnect:()=>null,onMessage:()=>null,onOutgoingMessage:()=>null,onStatus:()=>null,onSynced:()=>null,onDisconnect:()=>null,onClose:()=>null,onDestroy:()=>null,onAwarenessUpdate:()=>null,onAwarenessChange:()=>null,quiet:!1},this.subscribedToBroadcastChannel=!1,this.webSocket=null,this.shouldConnect=!0,this.status=l.Disconnected,this.isSynced=!1,this.unsyncedChanges=0,this.isAuthenticated=!1,this.lastMessageReceived=0,this.mux=eC(),this.intervals={forceSync:null,connectionChecker:null},this.connectionAttempt=null,this.boundConnect=this.connect.bind(this),this.boundBeforeUnload=this.beforeUnload.bind(this),this.boundBroadcastChannelSubscriber=this.broadcastChannelSubscriber.bind(this),this.setConfiguration(e),this.configuration.document=e.document?e.document:new u.QW,this.configuration.awareness=e.awareness?e.awareness:new ew(this.document),this.configuration.WebSocketPolyfill=e.WebSocketPolyfill?e.WebSocketPolyfill:WebSocket,this.on("open",this.configuration.onOpen),this.on("authenticated",this.configuration.onAuthenticated),this.on("authenticationFailed",this.configuration.onAuthenticationFailed),this.on("connect",this.configuration.onConnect),this.on("message",this.configuration.onMessage),this.on("outgoingMessage",this.configuration.onOutgoingMessage),this.on("synced",this.configuration.onSynced),this.on("status",this.configuration.onStatus),this.on("disconnect",this.configuration.onDisconnect),this.on("close",this.configuration.onClose),this.on("destroy",this.configuration.onDestroy),this.on("awarenessUpdate",this.configuration.onAwarenessUpdate),this.on("awarenessChange",this.configuration.onAwarenessChange),this.awareness.on("update",()=>{this.emit("awarenessUpdate",{states:(0,f.QX)(this.awareness.getStates())})}),this.awareness.on("change",()=>{this.emit("awarenessChange",{states:(0,f.QX)(this.awareness.getStates())})}),this.document.on("update",this.documentUpdateHandler.bind(this)),this.awareness.on("update",this.awarenessUpdateHandler.bind(this)),this.registerEventListeners(),this.intervals.connectionChecker=setInterval(this.checkConnection.bind(this),this.configuration.messageReconnectTimeout/10),this.configuration.forceSyncInterval&&(this.intervals.forceSync=setInterval(this.forceSync.bind(this),this.configuration.forceSyncInterval)),void 0!==e.connect&&(this.shouldConnect=e.connect),!this.shouldConnect)return;this.connect()}setConfiguration(e={}){this.configuration={...this.configuration,...e}}async connect(){if(this.status===l.Connected)return;this.cancelWebsocketRetry&&(this.cancelWebsocketRetry(),this.cancelWebsocketRetry=void 0),this.unsyncedChanges=0,this.shouldConnect=!0,this.subscribeToBroadcastChannel();let{retryPromise:e,cancelFunc:t}=(()=>{let e=!1,t=p(this.createWebSocketConnection.bind(this),{delay:this.configuration.delay,initialDelay:this.configuration.initialDelay,factor:this.configuration.factor,maxAttempts:this.configuration.maxAttempts,minDelay:this.configuration.minDelay,maxDelay:this.configuration.maxDelay,jitter:this.configuration.jitter,timeout:this.configuration.timeout,beforeAttempt:t=>{(!this.shouldConnect||e)&&t.abort()}}).catch(e=>{if(e&&"ATTEMPT_ABORTED"!==e.code)throw e});return{retryPromise:t,cancelFunc:()=>{e=!0}}})();return this.cancelWebsocketRetry=t,e}createWebSocketConnection(){return new Promise((e,t)=>{this.webSocket&&(this.webSocket.close(),this.webSocket=null);let n=new this.configuration.WebSocketPolyfill(this.url);n.binaryType="arraybuffer",n.onmessage=this.onMessage.bind(this),n.onclose=this.onClose.bind(this),n.onopen=this.onOpen.bind(this),n.onerror=e=>{t(e)},this.webSocket=n,this.synced=!1,this.status=l.Connecting,this.emit("status",{status:l.Connecting}),this.connectionAttempt={resolve:e,reject:t}})}resolveConnectionAttempt(){var e;null===(e=this.connectionAttempt)||void 0===e||e.resolve(),this.connectionAttempt=null,this.status=l.Connected,this.emit("status",{status:l.Connected}),this.emit("connect")}stopConnectionAttempt(){this.connectionAttempt=null}rejectConnectionAttempt(){var e;null===(e=this.connectionAttempt)||void 0===e||e.reject(),this.connectionAttempt=null}get document(){return this.configuration.document}get awareness(){return this.configuration.awareness}get hasUnsyncedChanges(){return this.unsyncedChanges>0}checkConnection(){var e;this.status!==l.Connected||!this.lastMessageReceived||this.configuration.messageReconnectTimeout>=el()-this.lastMessageReceived||null===(e=this.webSocket)||void 0===e||e.close()}forceSync(){this.webSocket&&this.send(eP,{document:this.document})}beforeUnload(){eS(this.awareness,[this.document.clientID],"window unload")}registerEventListeners(){"undefined"!=typeof window&&(window.addEventListener("online",this.boundConnect),window.addEventListener("beforeunload",this.boundBeforeUnload))}documentUpdateHandler(e,t){t!==this&&(this.unsyncedChanges+=1,this.send(eN,{update:e},!0))}awarenessUpdateHandler({added:e,updated:t,removed:n},s){let o=e.concat(t).concat(n);this.send(eF,{awareness:this.awareness,clients:o},!0)}permissionDeniedHandler(e){this.emit("authenticationFailed",{reason:e}),this.isAuthenticated=!1,this.shouldConnect=!1}authenticatedHandler(){this.isAuthenticated=!0,this.emit("authenticated"),this.startSync()}get serverUrl(){for(;"/"===this.configuration.url[this.configuration.url.length-1];)return this.configuration.url.slice(0,this.configuration.url.length-1);return this.configuration.url}get url(){let e=eD(this.configuration.parameters);return`${this.serverUrl}/${this.configuration.name}${0===e.length?"":`?${e}`}`}get synced(){return this.isSynced}set synced(e){this.isSynced!==e&&(this.isSynced=e,this.emit("synced",{state:e}),this.emit("sync",{state:e}))}get isAuthenticationRequired(){return!!this.configuration.token&&!this.isAuthenticated}disconnect(){if(this.shouldConnect=!1,this.disconnectBroadcastChannel(),null!==this.webSocket)try{this.webSocket.close()}catch{}}async onOpen(e){if(this.emit("open",{event:e}),this.isAuthenticationRequired){this.send(ej,{token:await this.getToken()});return}this.startSync()}async getToken(){if("function"==typeof this.configuration.token){let e=await this.configuration.token();return e}return this.configuration.token}startSync(){this.send(eP,{document:this.document}),null!==this.awareness.getLocalState()&&this.send(eF,{awareness:this.awareness,clients:[this.document.clientID]})}send(e,t,n=!1){var s;if(n&&this.mux(()=>{this.broadcast(e,t)}),(null===(s=this.webSocket)||void 0===s?void 0:s.readyState)===f.$c.Open){let n=new eR(e,t);this.emit("outgoingMessage",{message:n.message}),n.send(this.webSocket)}}onMessage(e){this.resolveConnectionAttempt(),this.lastMessageReceived=el();let t=new eU(e.data);this.emit("message",{event:e,message:t}),new eB(t).apply(this)}onClose(e){this.emit("close",{event:e}),this.webSocket=null,this.isAuthenticated=!1,this.synced=!1,this.status===l.Connected&&(eS(this.awareness,Array.from(this.awareness.getStates().keys()).filter(e=>e!==this.document.clientID),this),this.status=l.Disconnected,this.emit("status",{status:l.Disconnected}),this.emit("disconnect",{event:e})),e.code===f.NI.code&&(this.configuration.quiet||console.warn("[HocuspocusProvider] An authentication token is required, but you didn’t send one. Try adding a `token` to your HocuspocusProvider configuration. Won’t try again."),this.shouldConnect=!1),e.code!==f.rN.code||this.configuration.quiet||console.warn("[HocuspocusProvider] The provided authentication token isn’t allowed to connect to this server. Will try again."),this.connectionAttempt?this.rejectConnectionAttempt():this.shouldConnect&&this.connect(),this.shouldConnect||this.status===l.Disconnected||(this.status=l.Disconnected,this.emit("status",{status:l.Disconnected}),this.emit("disconnect",{event:e}))}destroy(){this.emit("destroy"),this.intervals.forceSync&&clearInterval(this.intervals.forceSync),clearInterval(this.intervals.connectionChecker),eS(this.awareness,[this.document.clientID],"provider destroy"),this.stopConnectionAttempt(),this.disconnect(),this.awareness.off("update",this.awarenessUpdateHandler),this.document.off("update",this.documentUpdateHandler),this.removeAllListeners(),"undefined"!=typeof window&&(window.removeEventListener("online",this.boundConnect),window.removeEventListener("beforeunload",this.boundBeforeUnload))}get broadcastChannel(){return`${this.serverUrl}/${this.configuration.name}`}broadcastChannelSubscriber(e){this.mux(()=>{let t=new eU(e);new eB(t).setBroadcasted(!0).apply(this,!1)})}subscribeToBroadcastChannel(){this.subscribedToBroadcastChannel||(er(this.broadcastChannel,this.boundBroadcastChannelSubscriber),this.subscribedToBroadcastChannel=!0),this.mux(()=>{this.broadcast(eP,{document:this.document}),this.broadcast(eV,{document:this.document}),this.broadcast(eO),this.broadcast(eF,{awareness:this.awareness,clients:[this.document.clientID]})})}disconnectBroadcastChannel(){this.send(eF,{awareness:this.awareness,clients:[this.document.clientID],states:new Map},!0),this.subscribedToBroadcastChannel&&(ea(this.broadcastChannel,this.boundBroadcastChannelSubscriber),this.subscribedToBroadcastChannel=!1)}broadcast(e,t){this.configuration.broadcast&&this.subscribedToBroadcastChannel&&new eR(e,t).broadcast(this.broadcastChannel)}setAwarenessField(e,t){this.awareness.setLocalStateField(e,t)}}},64652:function(e,t,n){n.d(t,{ZT:function(){return U}});var s=n(72338);let o=(0,s.DS)({find:/--$/,replace:"—"}),i=(0,s.DS)({find:/\.\.\.$/,replace:"…"}),r=(0,s.DS)({find:/(?:^|[\s{[(<'"\u2018\u201C])(")$/,replace:"“"}),a=(0,s.DS)({find:/"$/,replace:"”"}),c=(0,s.DS)({find:/(?:^|[\s{[(<'"\u2018\u201C])(')$/,replace:"‘"}),l=(0,s.DS)({find:/'$/,replace:"’"}),u=(0,s.DS)({find:/<-$/,replace:"←"}),h=(0,s.DS)({find:/->$/,replace:"→"}),d=(0,s.DS)({find:/\(c\)$/,replace:"\xa9"}),p=(0,s.DS)({find:/\(tm\)$/,replace:"™"}),f=(0,s.DS)({find:/\(sm\)$/,replace:"℠"}),g=(0,s.DS)({find:/\(r\)$/,replace:"\xae"}),m=(0,s.DS)({find:/(?:^|\s)(1\/2)$/,replace:"\xbd"}),y=(0,s.DS)({find:/\+\/-$/,replace:"\xb1"}),b=(0,s.DS)({find:/!=$/,replace:"≠"}),w=(0,s.DS)({find:/<<$/,replace:"\xab"}),S=(0,s.DS)({find:/>>$/,replace:"\xbb"}),v=(0,s.DS)({find:/\d+\s?([*x])\s?\d+$/,replace:"\xd7"}),A=(0,s.DS)({find:/\^2$/,replace:"\xb2"}),C=(0,s.DS)({find:/\^3$/,replace:"\xb3"}),D=(0,s.DS)({find:/(?:^|\s)(1\/4)$/,replace:"\xbc"}),k=(0,s.DS)({find:/(?:^|\s)(3\/4)$/,replace:"\xbe"}),U=s.hj.create({name:"typography",addInputRules(){let e=[];return!1!==this.options.emDash&&e.push(o),!1!==this.options.ellipsis&&e.push(i),!1!==this.options.openDoubleQuote&&e.push(r),!1!==this.options.closeDoubleQuote&&e.push(a),!1!==this.options.openSingleQuote&&e.push(c),!1!==this.options.closeSingleQuote&&e.push(l),!1!==this.options.leftArrow&&e.push(u),!1!==this.options.rightArrow&&e.push(h),!1!==this.options.copyright&&e.push(d),!1!==this.options.trademark&&e.push(p),!1!==this.options.servicemark&&e.push(f),!1!==this.options.registeredTrademark&&e.push(g),!1!==this.options.oneHalf&&e.push(m),!1!==this.options.plusMinus&&e.push(y),!1!==this.options.notEqual&&e.push(b),!1!==this.options.laquo&&e.push(w),!1!==this.options.raquo&&e.push(S),!1!==this.options.multiplication&&e.push(v),!1!==this.options.superscriptTwo&&e.push(A),!1!==this.options.superscriptThree&&e.push(C),!1!==this.options.oneQuarter&&e.push(D),!1!==this.options.threeQuarters&&e.push(k),e}})},81617:function(e,t,n){n.d(t,{IV:function(){return d},Lj:function(){return a},QX:function(){return u},S_:function(){return y},U2:function(){return h},UE:function(){return v},X3:function(){return r},_w:function(){return c},ay:function(){return l},go:function(){return g},gz:function(){return p},sc:function(){return A},yP:function(){return f}});var s=n(50798),o=n(55924);let i=e=>s.Ue((t,n)=>{e.onerror=e=>n(Error(e.target.error)),e.onblocked=()=>location.reload(),e.onsuccess=e=>t(e.target.result)}),r=(e,t)=>s.Ue((n,s)=>{let i=indexedDB.open(e);i.onupgradeneeded=e=>t(e.target.result),i.onerror=e=>s(o.Ue(e.target.error)),i.onblocked=()=>location.reload(),i.onsuccess=e=>{let t=e.target.result;t.onversionchange=()=>{t.close()},"undefined"!=typeof addEventListener&&addEventListener("unload",()=>t.close()),n(t)}}),a=e=>i(indexedDB.deleteDatabase(e)),c=(e,t)=>t.forEach(t=>e.createObjectStore.apply(e,t)),l=(e,t,n="readwrite")=>{let s=e.transaction(t,n);return t.map(e=>S(s,e))},u=(e,t)=>i(e.count(t)),h=(e,t)=>i(e.get(t)),d=(e,t)=>i(e.delete(t)),p=(e,t,n)=>i(e.put(t,n)),f=(e,t)=>i(e.add(t)),g=(e,t)=>i(e.getAll(t)),m=(e,t,n)=>{let s=null;return w(e,t,e=>(s=e,!1),n).then(()=>s)},y=(e,t=null)=>m(e,t,"prev"),b=(e,t)=>s.Ue((n,s)=>{e.onerror=s,e.onsuccess=e=>{let s=e.target.result;if(null===s||!1===t(s))return n();s.continue()}}),w=(e,t,n,s="next")=>b(e.openKeyCursor(t,s),e=>n(e.key)),S=(e,t)=>e.objectStore(t),v=(e,t)=>IDBKeyRange.upperBound(e,t),A=(e,t)=>IDBKeyRange.lowerBound(e,t)}}]);
//# sourceMappingURL=5063-b5d84f82aa034b9e.js.map